#include <ConstDiffusionModDecl.h> 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs2_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs23_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs23_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs234_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs234_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs234_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[2]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[2]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs1234_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs1234_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs1234_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[2]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[2]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs1234_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[3]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[3]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs123_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs123_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs123_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[2]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[2]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs24_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs24_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs124_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs124_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs124_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[2]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[2]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs12_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs12_X2(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[1]*dxl[1]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[1]*dxr[1]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[12])+0.6708203932499369*fl[12]+1.190784930203603*fr[2]+1.190784930203603*fl[2]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[20])+0.6708203932499369*fl[20]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = 1.161895003862225*fr[12]-1.161895003862225*fl[12]-2.0625*fr[2]-2.0625*fl[2]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[3] = (-0.6708203932499369*fr[22])+0.6708203932499369*fl[22]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[26])+0.6708203932499369*fl[26]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[20]-1.161895003862225*fl[20]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[6] = (-0.6708203932499369*fr[33])+0.6708203932499369*fl[33]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = 1.161895003862225*fr[22]-1.161895003862225*fl[22]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[8] = (-0.6708203932499369*fr[36])+0.6708203932499369*fl[36]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = 1.161895003862225*fr[26]-1.161895003862225*fl[26]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[10] = (-0.6708203932499369*fr[38])+0.6708203932499369*fl[38]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = 1.190784930203603*fr[19]+1.190784930203603*fl[19]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = (-1.5*fr[12])+1.5*fl[12]+2.662676050517599*fr[2]+2.662676050517599*fl[2]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[13] = 1.190784930203603*fr[24]+1.190784930203603*fl[24]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[29]+1.190784930203603*fl[29]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[33]-1.161895003862225*fl[33]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[16] = 1.161895003862225*fr[36]-1.161895003862225*fl[36]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[17] = (-0.6708203932499369*fr[45])+0.6708203932499369*fl[45]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[17]+0.9375*fl[17]; 
  incr1[18] = 1.161895003862225*fr[38]-1.161895003862225*fl[38]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[19] = (-2.0625*fr[19])-2.0625*fl[19]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[20] = (-1.5*fr[20])+1.5*fl[20]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[21] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = (-1.5*fr[22])+1.5*fl[22]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[23] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = (-2.0625*fr[24])-2.0625*fl[24]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[25] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = (-1.5*fr[26])+1.5*fl[26]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[27] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = (-2.0625*fr[29])-2.0625*fl[29]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[30] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[45]-1.161895003862225*fl[45]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[17]-1.623797632095822*fl[17]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[33] = (-1.5*fr[33])+1.5*fl[33]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[36] = (-1.5*fr[36])+1.5*fl[36]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[37] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[37]+0.9375*fl[37]; 
  incr1[38] = (-1.5*fr[38])+1.5*fl[38]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[39] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[39]+0.9375*fl[39]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[42] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[42]+0.9375*fl[42]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[37]-1.623797632095823*fl[37]; 
  incr1[45] = (-1.5*fr[45])+1.5*fl[45]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[17]+2.096313728906053*fl[17]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[39]-1.623797632095823*fl[39]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[42]-1.623797632095823*fl[42]; 

  incr2[2] = 0.4236075534914363*fr[12]+0.4236075534914363*fl[12]-0.609375*fr[2]+0.609375*fl[2]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[20]+0.4236075534914363*fl[20]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[22]+0.4236075534914363*fl[22]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[9] = 0.4236075534914363*fr[26]+0.4236075534914363*fl[26]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[12] = (-1.640625*fr[12])-1.640625*fl[12]+2.360099226595144*fr[2]-2.360099226595144*fl[2]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[33]+0.4236075534914363*fl[33]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[16] = 0.4236075534914363*fr[36]+0.4236075534914363*fl[36]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[38]+0.4236075534914363*fl[38]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-0.609375*fr[19])+0.609375*fl[19]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[20] = (-1.640625*fr[20])-1.640625*fl[20]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[22] = (-1.640625*fr[22])-1.640625*fl[22]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[24] = (-0.609375*fr[24])+0.609375*fl[24]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[26] = (-1.640625*fr[26])-1.640625*fl[26]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[29] = (-0.609375*fr[29])+0.609375*fl[29]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[45]+0.4236075534914363*fl[45]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[17]+0.4330127018922193*fl[17]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[33] = (-1.640625*fr[33])-1.640625*fl[33]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[36] = (-1.640625*fr[36])-1.640625*fl[36]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[38] = (-1.640625*fr[38])-1.640625*fl[38]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[37]+0.4330127018922194*fl[37]; 
  incr2[45] = (-1.640625*fr[45])-1.640625*fl[45]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[17]-1.677050983124842*fl[17]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[39]+0.4330127018922194*fl[39]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[42]+0.4330127018922194*fl[42]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr2[2]*rdxSq4nur+incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr2[12]*rdxSq4nur+incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += incr1[2]*rdxSq4nul-1.0*incr2[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += incr2[12]*rdxSq4nul-1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += -1.0*incr1[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += incr1[19]*rdxSq4nul-1.0*incr2[19]*rdxSq4nul; 
  outl[20] += incr2[20]*rdxSq4nul-1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += incr2[22]*rdxSq4nul-1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr1[24]*rdxSq4nul-1.0*incr2[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += incr2[26]*rdxSq4nul-1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr1[29]*rdxSq4nul-1.0*incr2[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr2[33]*rdxSq4nul-1.0*incr1[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr2[36]*rdxSq4nul-1.0*incr1[36]*rdxSq4nul; 
  outl[37] += -1.0*incr1[37]*rdxSq4nul; 
  outl[38] += incr2[38]*rdxSq4nul-1.0*incr1[38]*rdxSq4nul; 
  outl[39] += -1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += -1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr2[45]*rdxSq4nul-1.0*incr1[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs3_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs34_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs34_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs134_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs134_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs134_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[2]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[2]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs13_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs13_X3(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[2]*dxl[2]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[2]*dxr[2]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[13])+0.6708203932499369*fl[13]+1.190784930203603*fr[3]+1.190784930203603*fl[3]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[23])+0.6708203932499369*fl[23]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[24])+0.6708203932499369*fl[24]+1.190784930203603*fr[7]+1.190784930203603*fl[7]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = 1.161895003862225*fr[13]-1.161895003862225*fl[13]-2.0625*fr[3]-2.0625*fl[3]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[4] = (-0.6708203932499369*fr[27])+0.6708203932499369*fl[27]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = (-0.6708203932499369*fr[34])+0.6708203932499369*fl[34]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = 1.161895003862225*fr[23]-1.161895003862225*fl[23]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[7] = 1.161895003862225*fr[24]-1.161895003862225*fl[24]-2.0625*fr[7]-2.0625*fl[7]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[8] = (-0.6708203932499369*fr[39])+0.6708203932499369*fl[39]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[8]+0.9375*fl[8]; 
  incr1[9] = (-0.6708203932499369*fr[40])+0.6708203932499369*fl[40]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = 1.161895003862225*fr[27]-1.161895003862225*fl[27]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[11] = 1.190784930203603*fr[21]+1.190784930203603*fl[21]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[22]+1.190784930203603*fl[22]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = (-1.5*fr[13])+1.5*fl[13]+2.662676050517599*fr[3]+2.662676050517599*fl[3]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[14] = 1.190784930203603*fr[30]+1.190784930203603*fl[30]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[34]-1.161895003862225*fl[34]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[16] = (-0.6708203932499369*fr[46])+0.6708203932499369*fl[46]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[16]+0.9375*fl[16]; 
  incr1[17] = 1.161895003862225*fr[39]-1.161895003862225*fl[39]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[8]-1.623797632095822*fl[8]; 
  incr1[18] = 1.161895003862225*fr[40]-1.161895003862225*fl[40]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[19] = 1.190784930203603*fr[32]+1.190784930203603*fl[32]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = (-2.0625*fr[21])-2.0625*fl[21]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[22] = (-2.0625*fr[22])-2.0625*fl[22]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[23] = (-1.5*fr[23])+1.5*fl[23]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[24] = (-1.5*fr[24])+1.5*fl[24]+2.662676050517599*fr[7]+2.662676050517599*fl[7]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[25] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[25]+0.9375*fl[25]; 
  incr1[26] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = (-1.5*fr[27])+1.5*fl[27]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[28] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[28]+0.9375*fl[28]; 
  incr1[29] = 1.190784930203603*fr[43]+1.190784930203603*fl[43]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = (-2.0625*fr[30])-2.0625*fl[30]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[31] = 1.161895003862225*fr[46]-1.161895003862225*fl[46]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[16]-1.623797632095822*fl[16]; 
  incr1[32] = (-2.0625*fr[32])-2.0625*fl[32]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[34] = (-1.5*fr[34])+1.5*fl[34]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[35] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[35]+0.9375*fl[35]; 
  incr1[36] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[36]+0.9375*fl[36]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[25]-1.623797632095823*fl[25]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[39] = (-1.5*fr[39])+1.5*fl[39]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[8]+2.096313728906053*fl[8]; 
  incr1[40] = (-1.5*fr[40])+1.5*fl[40]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[41] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[41]+0.9375*fl[41]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[28]-1.623797632095823*fl[28]; 
  incr1[43] = (-2.0625*fr[43])-2.0625*fl[43]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[35]-1.623797632095823*fl[35]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[36]-1.623797632095823*fl[36]; 
  incr1[46] = (-1.5*fr[46])+1.5*fl[46]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[16]+2.096313728906053*fl[16]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[41]-1.623797632095823*fl[41]; 

  incr2[3] = 0.4236075534914363*fr[13]+0.4236075534914363*fl[13]-0.609375*fr[3]+0.609375*fl[3]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[6] = 0.4236075534914363*fr[23]+0.4236075534914363*fl[23]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[7] = 0.4236075534914363*fr[24]+0.4236075534914363*fl[24]-0.609375*fr[7]+0.609375*fl[7]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[27]+0.4236075534914363*fl[27]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[13] = (-1.640625*fr[13])-1.640625*fl[13]+2.360099226595144*fr[3]-2.360099226595144*fl[3]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[34]+0.4236075534914363*fl[34]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[39]+0.4236075534914363*fl[39]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[8]+0.4330127018922193*fl[8]; 
  incr2[18] = 0.4236075534914363*fr[40]+0.4236075534914363*fl[40]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[21] = (-0.609375*fr[21])+0.609375*fl[21]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[22] = (-0.609375*fr[22])+0.609375*fl[22]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[23] = (-1.640625*fr[23])-1.640625*fl[23]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[24] = (-1.640625*fr[24])-1.640625*fl[24]+2.360099226595145*fr[7]-2.360099226595145*fl[7]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[27] = (-1.640625*fr[27])-1.640625*fl[27]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[30] = (-0.609375*fr[30])+0.609375*fl[30]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[46]+0.4236075534914363*fl[46]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[16]+0.4330127018922193*fl[16]; 
  incr2[32] = (-0.609375*fr[32])+0.609375*fl[32]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[34] = (-1.640625*fr[34])-1.640625*fl[34]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[25]+0.4330127018922194*fl[25]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[39] = (-1.640625*fr[39])-1.640625*fl[39]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[8]-1.677050983124842*fl[8]; 
  incr2[40] = (-1.640625*fr[40])-1.640625*fl[40]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[28]+0.4330127018922194*fl[28]; 
  incr2[43] = (-0.609375*fr[43])+0.609375*fl[43]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[35]+0.4330127018922194*fl[35]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[36]+0.4330127018922194*fl[36]; 
  incr2[46] = (-1.640625*fr[46])-1.640625*fl[46]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[16]-1.677050983124842*fl[16]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[41]+0.4330127018922194*fl[41]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr2[3]*rdxSq4nur+incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr2[7]*rdxSq4nur+incr1[7]*rdxSq4nur; 
  outr[8] += incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr2[13]*rdxSq4nur+incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr2[22]*rdxSq4nur+incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr2[24]*rdxSq4nur+incr1[24]*rdxSq4nur; 
  outr[25] += incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr1[35]*rdxSq4nur; 
  outr[36] += incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += incr1[3]*rdxSq4nul-1.0*incr2[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += incr1[7]*rdxSq4nul-1.0*incr2[7]*rdxSq4nul; 
  outl[8] += -1.0*incr1[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += incr2[13]*rdxSq4nul-1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += -1.0*incr1[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += incr1[21]*rdxSq4nul-1.0*incr2[21]*rdxSq4nul; 
  outl[22] += incr1[22]*rdxSq4nul-1.0*incr2[22]*rdxSq4nul; 
  outl[23] += incr2[23]*rdxSq4nul-1.0*incr1[23]*rdxSq4nul; 
  outl[24] += incr2[24]*rdxSq4nul-1.0*incr1[24]*rdxSq4nul; 
  outl[25] += -1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += incr2[27]*rdxSq4nul-1.0*incr1[27]*rdxSq4nul; 
  outl[28] += -1.0*incr1[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr1[30]*rdxSq4nul-1.0*incr2[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr1[32]*rdxSq4nul-1.0*incr2[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr2[34]*rdxSq4nul-1.0*incr1[34]*rdxSq4nul; 
  outl[35] += -1.0*incr1[35]*rdxSq4nul; 
  outl[36] += -1.0*incr1[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr2[39]*rdxSq4nul-1.0*incr1[39]*rdxSq4nul; 
  outl[40] += incr2[40]*rdxSq4nul-1.0*incr1[40]*rdxSq4nul; 
  outl[41] += -1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += incr1[43]*rdxSq4nul-1.0*incr2[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr2[46]*rdxSq4nul-1.0*incr1[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs4_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs14_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs14_X4(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[1]/(dxl[3]*dxl[3]); 
  double rdxSq4nur = 4.0*nu[1]/(dxr[3]*dxr[3]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[14])+0.6708203932499369*fl[14]+1.190784930203603*fr[4]+1.190784930203603*fl[4]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = (-0.6708203932499369*fr[28])+0.6708203932499369*fl[28]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[1]+0.9375*fl[1]; 
  incr1[2] = (-0.6708203932499369*fr[29])+0.6708203932499369*fl[29]+1.190784930203603*fr[9]+1.190784930203603*fl[9]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[30])+0.6708203932499369*fl[30]+1.190784930203603*fr[10]+1.190784930203603*fl[10]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = 1.161895003862225*fr[14]-1.161895003862225*fl[14]-2.0625*fr[4]-2.0625*fl[4]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[5] = (-0.6708203932499369*fr[41])+0.6708203932499369*fl[41]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[5]+0.9375*fl[5]; 
  incr1[6] = (-0.6708203932499369*fr[42])+0.6708203932499369*fl[42]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[6]+0.9375*fl[6]; 
  incr1[7] = (-0.6708203932499369*fr[43])+0.6708203932499369*fl[43]+1.190784930203603*fr[18]+1.190784930203603*fl[18]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[28]-1.161895003862225*fl[28]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[1]-1.623797632095822*fl[1]; 
  incr1[9] = 1.161895003862225*fr[29]-1.161895003862225*fl[29]-2.0625*fr[9]-2.0625*fl[9]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[10] = 1.161895003862225*fr[30]-1.161895003862225*fl[30]-2.0625*fr[10]-2.0625*fl[10]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[11] = 1.190784930203603*fr[25]+1.190784930203603*fl[25]-0.9375*fr[11]+0.9375*fl[11]; 
  incr1[12] = 1.190784930203603*fr[26]+1.190784930203603*fl[26]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[27]+1.190784930203603*fl[27]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = (-1.5*fr[14])+1.5*fl[14]+2.662676050517599*fr[4]+2.662676050517599*fl[4]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[15] = (-0.6708203932499369*fr[47])+0.6708203932499369*fl[47]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[15]+0.9375*fl[15]; 
  incr1[16] = 1.161895003862225*fr[41]-1.161895003862225*fl[41]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[5]-1.623797632095822*fl[5]; 
  incr1[17] = 1.161895003862225*fr[42]-1.161895003862225*fl[42]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[6]-1.623797632095822*fl[6]; 
  incr1[18] = 1.161895003862225*fr[43]-1.161895003862225*fl[43]-2.0625*fr[18]-2.0625*fl[18]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[19] = 1.190784930203603*fr[35]+1.190784930203603*fl[35]-0.9375*fr[19]+0.9375*fl[19]; 
  incr1[20] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[20]+0.9375*fl[20]; 
  incr1[21] = 1.190784930203603*fr[37]+1.190784930203603*fl[37]-0.9375*fr[21]+0.9375*fl[21]; 
  incr1[22] = 1.190784930203603*fr[38]+1.190784930203603*fl[38]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[23]+0.9375*fl[23]; 
  incr1[24] = 1.190784930203603*fr[40]+1.190784930203603*fl[40]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-2.0625*fr[25])-2.0625*fl[25]+1.623797632095823*fr[11]-1.623797632095823*fl[11]; 
  incr1[26] = (-2.0625*fr[26])-2.0625*fl[26]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[27] = (-2.0625*fr[27])-2.0625*fl[27]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[28] = (-1.5*fr[28])+1.5*fl[28]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[1]+2.096313728906053*fl[1]; 
  incr1[29] = (-1.5*fr[29])+1.5*fl[29]+2.662676050517599*fr[9]+2.662676050517599*fl[9]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[30] = (-1.5*fr[30])+1.5*fl[30]+2.662676050517599*fr[10]+2.662676050517599*fl[10]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[31] = 1.161895003862225*fr[47]-1.161895003862225*fl[47]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[15]-1.623797632095822*fl[15]; 
  incr1[32] = 1.190784930203603*fr[44]+1.190784930203603*fl[44]-0.9375*fr[32]+0.9375*fl[32]; 
  incr1[33] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[33]+0.9375*fl[33]; 
  incr1[34] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[34]+0.9375*fl[34]; 
  incr1[35] = (-2.0625*fr[35])-2.0625*fl[35]+1.623797632095823*fr[19]-1.623797632095823*fl[19]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[20]-1.623797632095823*fl[20]; 
  incr1[37] = (-2.0625*fr[37])-2.0625*fl[37]+1.623797632095823*fr[21]-1.623797632095823*fl[21]; 
  incr1[38] = (-2.0625*fr[38])-2.0625*fl[38]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[23]-1.623797632095823*fl[23]; 
  incr1[40] = (-2.0625*fr[40])-2.0625*fl[40]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[41] = (-1.5*fr[41])+1.5*fl[41]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[5]+2.096313728906053*fl[5]; 
  incr1[42] = (-1.5*fr[42])+1.5*fl[42]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[6]+2.096313728906053*fl[6]; 
  incr1[43] = (-1.5*fr[43])+1.5*fl[43]+2.662676050517599*fr[18]+2.662676050517599*fl[18]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[44] = (-2.0625*fr[44])-2.0625*fl[44]+1.623797632095823*fr[32]-1.623797632095823*fl[32]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[33]-1.623797632095823*fl[33]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[34]-1.623797632095823*fl[34]; 
  incr1[47] = (-1.5*fr[47])+1.5*fl[47]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[15]+2.096313728906053*fl[15]; 

  incr2[4] = 0.4236075534914363*fr[14]+0.4236075534914363*fl[14]-0.609375*fr[4]+0.609375*fl[4]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[8] = 0.4236075534914363*fr[28]+0.4236075534914363*fl[28]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[1]+0.4330127018922193*fl[1]; 
  incr2[9] = 0.4236075534914363*fr[29]+0.4236075534914363*fl[29]-0.609375*fr[9]+0.609375*fl[9]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[10] = 0.4236075534914363*fr[30]+0.4236075534914363*fl[30]-0.609375*fr[10]+0.609375*fl[10]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[14] = (-1.640625*fr[14])-1.640625*fl[14]+2.360099226595144*fr[4]-2.360099226595144*fl[4]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[16] = 0.4236075534914363*fr[41]+0.4236075534914363*fl[41]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[5]+0.4330127018922193*fl[5]; 
  incr2[17] = 0.4236075534914363*fr[42]+0.4236075534914363*fl[42]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[6]+0.4330127018922193*fl[6]; 
  incr2[18] = 0.4236075534914363*fr[43]+0.4236075534914363*fl[43]-0.609375*fr[18]+0.609375*fl[18]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[25] = (-0.609375*fr[25])+0.609375*fl[25]+0.4330127018922194*fr[11]+0.4330127018922194*fl[11]; 
  incr2[26] = (-0.609375*fr[26])+0.609375*fl[26]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[27] = (-0.609375*fr[27])+0.609375*fl[27]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[28] = (-1.640625*fr[28])-1.640625*fl[28]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[1]-1.677050983124842*fl[1]; 
  incr2[29] = (-1.640625*fr[29])-1.640625*fl[29]+2.360099226595145*fr[9]-2.360099226595145*fl[9]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[30] = (-1.640625*fr[30])-1.640625*fl[30]+2.360099226595145*fr[10]-2.360099226595145*fl[10]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[31] = 0.4236075534914363*fr[47]+0.4236075534914363*fl[47]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[15]+0.4330127018922193*fl[15]; 
  incr2[35] = (-0.609375*fr[35])+0.609375*fl[35]+0.4330127018922194*fr[19]+0.4330127018922194*fl[19]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[20]+0.4330127018922194*fl[20]; 
  incr2[37] = (-0.609375*fr[37])+0.609375*fl[37]+0.4330127018922194*fr[21]+0.4330127018922194*fl[21]; 
  incr2[38] = (-0.609375*fr[38])+0.609375*fl[38]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[23]+0.4330127018922194*fl[23]; 
  incr2[40] = (-0.609375*fr[40])+0.609375*fl[40]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[41] = (-1.640625*fr[41])-1.640625*fl[41]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[5]-1.677050983124842*fl[5]; 
  incr2[42] = (-1.640625*fr[42])-1.640625*fl[42]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[6]-1.677050983124842*fl[6]; 
  incr2[43] = (-1.640625*fr[43])-1.640625*fl[43]+2.360099226595144*fr[18]-2.360099226595144*fl[18]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[44] = (-0.609375*fr[44])+0.609375*fl[44]+0.4330127018922194*fr[32]+0.4330127018922194*fl[32]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[33]+0.4330127018922194*fl[33]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[34]+0.4330127018922194*fl[34]; 
  incr2[47] = (-1.640625*fr[47])-1.640625*fl[47]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[15]-1.677050983124842*fl[15]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr2[4]*rdxSq4nur+incr1[4]*rdxSq4nur; 
  outr[5] += incr1[5]*rdxSq4nur; 
  outr[6] += incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr2[9]*rdxSq4nur+incr1[9]*rdxSq4nur; 
  outr[10] += incr2[10]*rdxSq4nur+incr1[10]*rdxSq4nur; 
  outr[11] += incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr2[14]*rdxSq4nur+incr1[14]*rdxSq4nur; 
  outr[15] += incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr2[18]*rdxSq4nur+incr1[18]*rdxSq4nur; 
  outr[19] += incr1[19]*rdxSq4nur; 
  outr[20] += incr1[20]*rdxSq4nur; 
  outr[21] += incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr2[26]*rdxSq4nur+incr1[26]*rdxSq4nur; 
  outr[27] += incr2[27]*rdxSq4nur+incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr2[29]*rdxSq4nur+incr1[29]*rdxSq4nur; 
  outr[30] += incr2[30]*rdxSq4nur+incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr1[32]*rdxSq4nur; 
  outr[33] += incr1[33]*rdxSq4nur; 
  outr[34] += incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr2[38]*rdxSq4nur+incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr2[40]*rdxSq4nur+incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr2[43]*rdxSq4nur+incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += -1.0*incr1[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += incr1[4]*rdxSq4nul-1.0*incr2[4]*rdxSq4nul; 
  outl[5] += -1.0*incr1[5]*rdxSq4nul; 
  outl[6] += -1.0*incr1[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += incr1[9]*rdxSq4nul-1.0*incr2[9]*rdxSq4nul; 
  outl[10] += incr1[10]*rdxSq4nul-1.0*incr2[10]*rdxSq4nul; 
  outl[11] += -1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += incr2[14]*rdxSq4nul-1.0*incr1[14]*rdxSq4nul; 
  outl[15] += -1.0*incr1[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += incr1[18]*rdxSq4nul-1.0*incr2[18]*rdxSq4nul; 
  outl[19] += -1.0*incr1[19]*rdxSq4nul; 
  outl[20] += -1.0*incr1[20]*rdxSq4nul; 
  outl[21] += -1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += -1.0*incr1[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr1[25]*rdxSq4nul-1.0*incr2[25]*rdxSq4nul; 
  outl[26] += incr1[26]*rdxSq4nul-1.0*incr2[26]*rdxSq4nul; 
  outl[27] += incr1[27]*rdxSq4nul-1.0*incr2[27]*rdxSq4nul; 
  outl[28] += incr2[28]*rdxSq4nul-1.0*incr1[28]*rdxSq4nul; 
  outl[29] += incr2[29]*rdxSq4nul-1.0*incr1[29]*rdxSq4nul; 
  outl[30] += incr2[30]*rdxSq4nul-1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += -1.0*incr1[32]*rdxSq4nul; 
  outl[33] += -1.0*incr1[33]*rdxSq4nul; 
  outl[34] += -1.0*incr1[34]*rdxSq4nul; 
  outl[35] += incr1[35]*rdxSq4nul-1.0*incr2[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr1[37]*rdxSq4nul-1.0*incr2[37]*rdxSq4nul; 
  outl[38] += incr1[38]*rdxSq4nul-1.0*incr2[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += incr1[40]*rdxSq4nul-1.0*incr2[40]*rdxSq4nul; 
  outl[41] += incr2[41]*rdxSq4nul-1.0*incr1[41]*rdxSq4nul; 
  outl[42] += incr2[42]*rdxSq4nul-1.0*incr1[42]*rdxSq4nul; 
  outl[43] += incr2[43]*rdxSq4nul-1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr1[44]*rdxSq4nul-1.0*incr2[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr2[47]*rdxSq4nul-1.0*incr1[47]*rdxSq4nul; 

} 
void ConstDiffusionBoundarySurf4xSerP2_diffDirs1_X1(const double *wl, const double *wr, const double *dxl, const double *dxr, const int *idxl, const int *idxr, const double *nu, const double *fl, const double *fr, double *outl, double *outr) 
{ 
  // w[4]:      Cell-center coordinates.
  // dx[4]:     Cell spacing.
  // idx[4]:    current grid index.
  // nu[4]:     diffusion coefficient (collisionality).
  // fl/fr:     Distribution function in left/right cells.
  // outl/outr: Incremented distribution function in left/right cells 
  double rdxSq4nul = 4.0*nu[0]/(dxl[0]*dxl[0]); 
  double rdxSq4nur = 4.0*nu[0]/(dxr[0]*dxr[0]); 

  double incr1[48]; 
  double incr2[48]; 

  incr1[0] = (-0.6708203932499369*fr[11])+0.6708203932499369*fl[11]+1.190784930203603*fr[1]+1.190784930203603*fl[1]-0.9375*fr[0]+0.9375*fl[0]; 
  incr1[1] = 1.161895003862225*fr[11]-1.161895003862225*fl[11]-2.0625*fr[1]-2.0625*fl[1]+1.623797632095822*fr[0]-1.623797632095822*fl[0]; 
  incr1[2] = (-0.6708203932499369*fr[19])+0.6708203932499369*fl[19]+1.190784930203603*fr[5]+1.190784930203603*fl[5]-0.9375*fr[2]+0.9375*fl[2]; 
  incr1[3] = (-0.6708203932499369*fr[21])+0.6708203932499369*fl[21]+1.190784930203603*fr[6]+1.190784930203603*fl[6]-0.9375*fr[3]+0.9375*fl[3]; 
  incr1[4] = (-0.6708203932499369*fr[25])+0.6708203932499369*fl[25]+1.190784930203603*fr[8]+1.190784930203603*fl[8]-0.9375*fr[4]+0.9375*fl[4]; 
  incr1[5] = 1.161895003862225*fr[19]-1.161895003862225*fl[19]-2.0625*fr[5]-2.0625*fl[5]+1.623797632095822*fr[2]-1.623797632095822*fl[2]; 
  incr1[6] = 1.161895003862225*fr[21]-1.161895003862225*fl[21]-2.0625*fr[6]-2.0625*fl[6]+1.623797632095822*fr[3]-1.623797632095822*fl[3]; 
  incr1[7] = (-0.6708203932499369*fr[32])+0.6708203932499369*fl[32]+1.190784930203603*fr[15]+1.190784930203603*fl[15]-0.9375*fr[7]+0.9375*fl[7]; 
  incr1[8] = 1.161895003862225*fr[25]-1.161895003862225*fl[25]-2.0625*fr[8]-2.0625*fl[8]+1.623797632095822*fr[4]-1.623797632095822*fl[4]; 
  incr1[9] = (-0.6708203932499369*fr[35])+0.6708203932499369*fl[35]+1.190784930203603*fr[16]+1.190784930203603*fl[16]-0.9375*fr[9]+0.9375*fl[9]; 
  incr1[10] = (-0.6708203932499369*fr[37])+0.6708203932499369*fl[37]+1.190784930203603*fr[17]+1.190784930203603*fl[17]-0.9375*fr[10]+0.9375*fl[10]; 
  incr1[11] = (-1.5*fr[11])+1.5*fl[11]+2.662676050517599*fr[1]+2.662676050517599*fl[1]-2.096313728906053*fr[0]+2.096313728906053*fl[0]; 
  incr1[12] = 1.190784930203603*fr[20]+1.190784930203603*fl[20]-0.9375*fr[12]+0.9375*fl[12]; 
  incr1[13] = 1.190784930203603*fr[23]+1.190784930203603*fl[23]-0.9375*fr[13]+0.9375*fl[13]; 
  incr1[14] = 1.190784930203603*fr[28]+1.190784930203603*fl[28]-0.9375*fr[14]+0.9375*fl[14]; 
  incr1[15] = 1.161895003862225*fr[32]-1.161895003862225*fl[32]-2.0625*fr[15]-2.0625*fl[15]+1.623797632095822*fr[7]-1.623797632095822*fl[7]; 
  incr1[16] = 1.161895003862225*fr[35]-1.161895003862225*fl[35]-2.0625*fr[16]-2.0625*fl[16]+1.623797632095822*fr[9]-1.623797632095822*fl[9]; 
  incr1[17] = 1.161895003862225*fr[37]-1.161895003862225*fl[37]-2.0625*fr[17]-2.0625*fl[17]+1.623797632095822*fr[10]-1.623797632095822*fl[10]; 
  incr1[18] = (-0.6708203932499369*fr[44])+0.6708203932499369*fl[44]+1.190784930203603*fr[31]+1.190784930203603*fl[31]-0.9375*fr[18]+0.9375*fl[18]; 
  incr1[19] = (-1.5*fr[19])+1.5*fl[19]+2.662676050517599*fr[5]+2.662676050517599*fl[5]-2.096313728906053*fr[2]+2.096313728906053*fl[2]; 
  incr1[20] = (-2.0625*fr[20])-2.0625*fl[20]+1.623797632095823*fr[12]-1.623797632095823*fl[12]; 
  incr1[21] = (-1.5*fr[21])+1.5*fl[21]+2.662676050517599*fr[6]+2.662676050517599*fl[6]-2.096313728906053*fr[3]+2.096313728906053*fl[3]; 
  incr1[22] = 1.190784930203603*fr[33]+1.190784930203603*fl[33]-0.9375*fr[22]+0.9375*fl[22]; 
  incr1[23] = (-2.0625*fr[23])-2.0625*fl[23]+1.623797632095823*fr[13]-1.623797632095823*fl[13]; 
  incr1[24] = 1.190784930203603*fr[34]+1.190784930203603*fl[34]-0.9375*fr[24]+0.9375*fl[24]; 
  incr1[25] = (-1.5*fr[25])+1.5*fl[25]+2.662676050517599*fr[8]+2.662676050517599*fl[8]-2.096313728906053*fr[4]+2.096313728906053*fl[4]; 
  incr1[26] = 1.190784930203603*fr[36]+1.190784930203603*fl[36]-0.9375*fr[26]+0.9375*fl[26]; 
  incr1[27] = 1.190784930203603*fr[39]+1.190784930203603*fl[39]-0.9375*fr[27]+0.9375*fl[27]; 
  incr1[28] = (-2.0625*fr[28])-2.0625*fl[28]+1.623797632095823*fr[14]-1.623797632095823*fl[14]; 
  incr1[29] = 1.190784930203603*fr[41]+1.190784930203603*fl[41]-0.9375*fr[29]+0.9375*fl[29]; 
  incr1[30] = 1.190784930203603*fr[42]+1.190784930203603*fl[42]-0.9375*fr[30]+0.9375*fl[30]; 
  incr1[31] = 1.161895003862225*fr[44]-1.161895003862225*fl[44]-2.0625*fr[31]-2.0625*fl[31]+1.623797632095822*fr[18]-1.623797632095822*fl[18]; 
  incr1[32] = (-1.5*fr[32])+1.5*fl[32]+2.662676050517599*fr[15]+2.662676050517599*fl[15]-2.096313728906053*fr[7]+2.096313728906053*fl[7]; 
  incr1[33] = (-2.0625*fr[33])-2.0625*fl[33]+1.623797632095823*fr[22]-1.623797632095823*fl[22]; 
  incr1[34] = (-2.0625*fr[34])-2.0625*fl[34]+1.623797632095823*fr[24]-1.623797632095823*fl[24]; 
  incr1[35] = (-1.5*fr[35])+1.5*fl[35]+2.662676050517599*fr[16]+2.662676050517599*fl[16]-2.096313728906053*fr[9]+2.096313728906053*fl[9]; 
  incr1[36] = (-2.0625*fr[36])-2.0625*fl[36]+1.623797632095823*fr[26]-1.623797632095823*fl[26]; 
  incr1[37] = (-1.5*fr[37])+1.5*fl[37]+2.662676050517599*fr[17]+2.662676050517599*fl[17]-2.096313728906053*fr[10]+2.096313728906053*fl[10]; 
  incr1[38] = 1.190784930203603*fr[45]+1.190784930203603*fl[45]-0.9375*fr[38]+0.9375*fl[38]; 
  incr1[39] = (-2.0625*fr[39])-2.0625*fl[39]+1.623797632095823*fr[27]-1.623797632095823*fl[27]; 
  incr1[40] = 1.190784930203603*fr[46]+1.190784930203603*fl[46]-0.9375*fr[40]+0.9375*fl[40]; 
  incr1[41] = (-2.0625*fr[41])-2.0625*fl[41]+1.623797632095823*fr[29]-1.623797632095823*fl[29]; 
  incr1[42] = (-2.0625*fr[42])-2.0625*fl[42]+1.623797632095823*fr[30]-1.623797632095823*fl[30]; 
  incr1[43] = 1.190784930203603*fr[47]+1.190784930203603*fl[47]-0.9375*fr[43]+0.9375*fl[43]; 
  incr1[44] = (-1.5*fr[44])+1.5*fl[44]+2.662676050517599*fr[31]+2.662676050517599*fl[31]-2.096313728906053*fr[18]+2.096313728906053*fl[18]; 
  incr1[45] = (-2.0625*fr[45])-2.0625*fl[45]+1.623797632095823*fr[38]-1.623797632095823*fl[38]; 
  incr1[46] = (-2.0625*fr[46])-2.0625*fl[46]+1.623797632095823*fr[40]-1.623797632095823*fl[40]; 
  incr1[47] = (-2.0625*fr[47])-2.0625*fl[47]+1.623797632095823*fr[43]-1.623797632095823*fl[43]; 

  incr2[1] = 0.4236075534914363*fr[11]+0.4236075534914363*fl[11]-0.609375*fr[1]+0.609375*fl[1]+0.4330127018922193*fr[0]+0.4330127018922193*fl[0]; 
  incr2[5] = 0.4236075534914363*fr[19]+0.4236075534914363*fl[19]-0.609375*fr[5]+0.609375*fl[5]+0.4330127018922193*fr[2]+0.4330127018922193*fl[2]; 
  incr2[6] = 0.4236075534914363*fr[21]+0.4236075534914363*fl[21]-0.609375*fr[6]+0.609375*fl[6]+0.4330127018922193*fr[3]+0.4330127018922193*fl[3]; 
  incr2[8] = 0.4236075534914363*fr[25]+0.4236075534914363*fl[25]-0.609375*fr[8]+0.609375*fl[8]+0.4330127018922193*fr[4]+0.4330127018922193*fl[4]; 
  incr2[11] = (-1.640625*fr[11])-1.640625*fl[11]+2.360099226595144*fr[1]-2.360099226595144*fl[1]-1.677050983124842*fr[0]-1.677050983124842*fl[0]; 
  incr2[15] = 0.4236075534914363*fr[32]+0.4236075534914363*fl[32]-0.609375*fr[15]+0.609375*fl[15]+0.4330127018922193*fr[7]+0.4330127018922193*fl[7]; 
  incr2[16] = 0.4236075534914363*fr[35]+0.4236075534914363*fl[35]-0.609375*fr[16]+0.609375*fl[16]+0.4330127018922193*fr[9]+0.4330127018922193*fl[9]; 
  incr2[17] = 0.4236075534914363*fr[37]+0.4236075534914363*fl[37]-0.609375*fr[17]+0.609375*fl[17]+0.4330127018922193*fr[10]+0.4330127018922193*fl[10]; 
  incr2[19] = (-1.640625*fr[19])-1.640625*fl[19]+2.360099226595145*fr[5]-2.360099226595145*fl[5]-1.677050983124842*fr[2]-1.677050983124842*fl[2]; 
  incr2[20] = (-0.609375*fr[20])+0.609375*fl[20]+0.4330127018922194*fr[12]+0.4330127018922194*fl[12]; 
  incr2[21] = (-1.640625*fr[21])-1.640625*fl[21]+2.360099226595145*fr[6]-2.360099226595145*fl[6]-1.677050983124842*fr[3]-1.677050983124842*fl[3]; 
  incr2[23] = (-0.609375*fr[23])+0.609375*fl[23]+0.4330127018922194*fr[13]+0.4330127018922194*fl[13]; 
  incr2[25] = (-1.640625*fr[25])-1.640625*fl[25]+2.360099226595145*fr[8]-2.360099226595145*fl[8]-1.677050983124842*fr[4]-1.677050983124842*fl[4]; 
  incr2[28] = (-0.609375*fr[28])+0.609375*fl[28]+0.4330127018922194*fr[14]+0.4330127018922194*fl[14]; 
  incr2[31] = 0.4236075534914363*fr[44]+0.4236075534914363*fl[44]-0.609375*fr[31]+0.609375*fl[31]+0.4330127018922193*fr[18]+0.4330127018922193*fl[18]; 
  incr2[32] = (-1.640625*fr[32])-1.640625*fl[32]+2.360099226595144*fr[15]-2.360099226595144*fl[15]-1.677050983124842*fr[7]-1.677050983124842*fl[7]; 
  incr2[33] = (-0.609375*fr[33])+0.609375*fl[33]+0.4330127018922194*fr[22]+0.4330127018922194*fl[22]; 
  incr2[34] = (-0.609375*fr[34])+0.609375*fl[34]+0.4330127018922194*fr[24]+0.4330127018922194*fl[24]; 
  incr2[35] = (-1.640625*fr[35])-1.640625*fl[35]+2.360099226595144*fr[16]-2.360099226595144*fl[16]-1.677050983124842*fr[9]-1.677050983124842*fl[9]; 
  incr2[36] = (-0.609375*fr[36])+0.609375*fl[36]+0.4330127018922194*fr[26]+0.4330127018922194*fl[26]; 
  incr2[37] = (-1.640625*fr[37])-1.640625*fl[37]+2.360099226595144*fr[17]-2.360099226595144*fl[17]-1.677050983124842*fr[10]-1.677050983124842*fl[10]; 
  incr2[39] = (-0.609375*fr[39])+0.609375*fl[39]+0.4330127018922194*fr[27]+0.4330127018922194*fl[27]; 
  incr2[41] = (-0.609375*fr[41])+0.609375*fl[41]+0.4330127018922194*fr[29]+0.4330127018922194*fl[29]; 
  incr2[42] = (-0.609375*fr[42])+0.609375*fl[42]+0.4330127018922194*fr[30]+0.4330127018922194*fl[30]; 
  incr2[44] = (-1.640625*fr[44])-1.640625*fl[44]+2.360099226595145*fr[31]-2.360099226595145*fl[31]-1.677050983124842*fr[18]-1.677050983124842*fl[18]; 
  incr2[45] = (-0.609375*fr[45])+0.609375*fl[45]+0.4330127018922194*fr[38]+0.4330127018922194*fl[38]; 
  incr2[46] = (-0.609375*fr[46])+0.609375*fl[46]+0.4330127018922194*fr[40]+0.4330127018922194*fl[40]; 
  incr2[47] = (-0.609375*fr[47])+0.609375*fl[47]+0.4330127018922194*fr[43]+0.4330127018922194*fl[43]; 

  outr[0] += incr1[0]*rdxSq4nur; 
  outr[1] += incr2[1]*rdxSq4nur+incr1[1]*rdxSq4nur; 
  outr[2] += incr1[2]*rdxSq4nur; 
  outr[3] += incr1[3]*rdxSq4nur; 
  outr[4] += incr1[4]*rdxSq4nur; 
  outr[5] += incr2[5]*rdxSq4nur+incr1[5]*rdxSq4nur; 
  outr[6] += incr2[6]*rdxSq4nur+incr1[6]*rdxSq4nur; 
  outr[7] += incr1[7]*rdxSq4nur; 
  outr[8] += incr2[8]*rdxSq4nur+incr1[8]*rdxSq4nur; 
  outr[9] += incr1[9]*rdxSq4nur; 
  outr[10] += incr1[10]*rdxSq4nur; 
  outr[11] += incr2[11]*rdxSq4nur+incr1[11]*rdxSq4nur; 
  outr[12] += incr1[12]*rdxSq4nur; 
  outr[13] += incr1[13]*rdxSq4nur; 
  outr[14] += incr1[14]*rdxSq4nur; 
  outr[15] += incr2[15]*rdxSq4nur+incr1[15]*rdxSq4nur; 
  outr[16] += incr2[16]*rdxSq4nur+incr1[16]*rdxSq4nur; 
  outr[17] += incr2[17]*rdxSq4nur+incr1[17]*rdxSq4nur; 
  outr[18] += incr1[18]*rdxSq4nur; 
  outr[19] += incr2[19]*rdxSq4nur+incr1[19]*rdxSq4nur; 
  outr[20] += incr2[20]*rdxSq4nur+incr1[20]*rdxSq4nur; 
  outr[21] += incr2[21]*rdxSq4nur+incr1[21]*rdxSq4nur; 
  outr[22] += incr1[22]*rdxSq4nur; 
  outr[23] += incr2[23]*rdxSq4nur+incr1[23]*rdxSq4nur; 
  outr[24] += incr1[24]*rdxSq4nur; 
  outr[25] += incr2[25]*rdxSq4nur+incr1[25]*rdxSq4nur; 
  outr[26] += incr1[26]*rdxSq4nur; 
  outr[27] += incr1[27]*rdxSq4nur; 
  outr[28] += incr2[28]*rdxSq4nur+incr1[28]*rdxSq4nur; 
  outr[29] += incr1[29]*rdxSq4nur; 
  outr[30] += incr1[30]*rdxSq4nur; 
  outr[31] += incr2[31]*rdxSq4nur+incr1[31]*rdxSq4nur; 
  outr[32] += incr2[32]*rdxSq4nur+incr1[32]*rdxSq4nur; 
  outr[33] += incr2[33]*rdxSq4nur+incr1[33]*rdxSq4nur; 
  outr[34] += incr2[34]*rdxSq4nur+incr1[34]*rdxSq4nur; 
  outr[35] += incr2[35]*rdxSq4nur+incr1[35]*rdxSq4nur; 
  outr[36] += incr2[36]*rdxSq4nur+incr1[36]*rdxSq4nur; 
  outr[37] += incr2[37]*rdxSq4nur+incr1[37]*rdxSq4nur; 
  outr[38] += incr1[38]*rdxSq4nur; 
  outr[39] += incr2[39]*rdxSq4nur+incr1[39]*rdxSq4nur; 
  outr[40] += incr1[40]*rdxSq4nur; 
  outr[41] += incr2[41]*rdxSq4nur+incr1[41]*rdxSq4nur; 
  outr[42] += incr2[42]*rdxSq4nur+incr1[42]*rdxSq4nur; 
  outr[43] += incr1[43]*rdxSq4nur; 
  outr[44] += incr2[44]*rdxSq4nur+incr1[44]*rdxSq4nur; 
  outr[45] += incr2[45]*rdxSq4nur+incr1[45]*rdxSq4nur; 
  outr[46] += incr2[46]*rdxSq4nur+incr1[46]*rdxSq4nur; 
  outr[47] += incr2[47]*rdxSq4nur+incr1[47]*rdxSq4nur; 

  outl[0] += -1.0*incr1[0]*rdxSq4nul; 
  outl[1] += incr1[1]*rdxSq4nul-1.0*incr2[1]*rdxSq4nul; 
  outl[2] += -1.0*incr1[2]*rdxSq4nul; 
  outl[3] += -1.0*incr1[3]*rdxSq4nul; 
  outl[4] += -1.0*incr1[4]*rdxSq4nul; 
  outl[5] += incr1[5]*rdxSq4nul-1.0*incr2[5]*rdxSq4nul; 
  outl[6] += incr1[6]*rdxSq4nul-1.0*incr2[6]*rdxSq4nul; 
  outl[7] += -1.0*incr1[7]*rdxSq4nul; 
  outl[8] += incr1[8]*rdxSq4nul-1.0*incr2[8]*rdxSq4nul; 
  outl[9] += -1.0*incr1[9]*rdxSq4nul; 
  outl[10] += -1.0*incr1[10]*rdxSq4nul; 
  outl[11] += incr2[11]*rdxSq4nul-1.0*incr1[11]*rdxSq4nul; 
  outl[12] += -1.0*incr1[12]*rdxSq4nul; 
  outl[13] += -1.0*incr1[13]*rdxSq4nul; 
  outl[14] += -1.0*incr1[14]*rdxSq4nul; 
  outl[15] += incr1[15]*rdxSq4nul-1.0*incr2[15]*rdxSq4nul; 
  outl[16] += incr1[16]*rdxSq4nul-1.0*incr2[16]*rdxSq4nul; 
  outl[17] += incr1[17]*rdxSq4nul-1.0*incr2[17]*rdxSq4nul; 
  outl[18] += -1.0*incr1[18]*rdxSq4nul; 
  outl[19] += incr2[19]*rdxSq4nul-1.0*incr1[19]*rdxSq4nul; 
  outl[20] += incr1[20]*rdxSq4nul-1.0*incr2[20]*rdxSq4nul; 
  outl[21] += incr2[21]*rdxSq4nul-1.0*incr1[21]*rdxSq4nul; 
  outl[22] += -1.0*incr1[22]*rdxSq4nul; 
  outl[23] += incr1[23]*rdxSq4nul-1.0*incr2[23]*rdxSq4nul; 
  outl[24] += -1.0*incr1[24]*rdxSq4nul; 
  outl[25] += incr2[25]*rdxSq4nul-1.0*incr1[25]*rdxSq4nul; 
  outl[26] += -1.0*incr1[26]*rdxSq4nul; 
  outl[27] += -1.0*incr1[27]*rdxSq4nul; 
  outl[28] += incr1[28]*rdxSq4nul-1.0*incr2[28]*rdxSq4nul; 
  outl[29] += -1.0*incr1[29]*rdxSq4nul; 
  outl[30] += -1.0*incr1[30]*rdxSq4nul; 
  outl[31] += incr1[31]*rdxSq4nul-1.0*incr2[31]*rdxSq4nul; 
  outl[32] += incr2[32]*rdxSq4nul-1.0*incr1[32]*rdxSq4nul; 
  outl[33] += incr1[33]*rdxSq4nul-1.0*incr2[33]*rdxSq4nul; 
  outl[34] += incr1[34]*rdxSq4nul-1.0*incr2[34]*rdxSq4nul; 
  outl[35] += incr2[35]*rdxSq4nul-1.0*incr1[35]*rdxSq4nul; 
  outl[36] += incr1[36]*rdxSq4nul-1.0*incr2[36]*rdxSq4nul; 
  outl[37] += incr2[37]*rdxSq4nul-1.0*incr1[37]*rdxSq4nul; 
  outl[38] += -1.0*incr1[38]*rdxSq4nul; 
  outl[39] += incr1[39]*rdxSq4nul-1.0*incr2[39]*rdxSq4nul; 
  outl[40] += -1.0*incr1[40]*rdxSq4nul; 
  outl[41] += incr1[41]*rdxSq4nul-1.0*incr2[41]*rdxSq4nul; 
  outl[42] += incr1[42]*rdxSq4nul-1.0*incr2[42]*rdxSq4nul; 
  outl[43] += -1.0*incr1[43]*rdxSq4nul; 
  outl[44] += incr2[44]*rdxSq4nul-1.0*incr1[44]*rdxSq4nul; 
  outl[45] += incr1[45]*rdxSq4nul-1.0*incr2[45]*rdxSq4nul; 
  outl[46] += incr1[46]*rdxSq4nul-1.0*incr2[46]*rdxSq4nul; 
  outl[47] += incr1[47]*rdxSq4nul-1.0*incr2[47]*rdxSq4nul; 

} 
